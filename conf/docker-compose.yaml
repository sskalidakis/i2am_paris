version: '3.6'

volumes:
  i2amparis_db_volume:

services:
  i2amparis_db:
    build: .
    hostname: i2amparis_db
    container_name: i2amparis_db
    restart: always
    command: ["-c", "shared_buffers=3GB", "-c", "max_connections=1000", "-c", "idle_in_transaction_session_timeout=1min"]
    ports:
      - 5435:5432
    volumes:
      - i2amparis_db_volume:/var/lib/postgresql/data
      - ../db_new.sqlite3:/var/lib/sqlite3/db_new.sqlite3
      - ./migration_from_sqlite3_to_postgres_command:/migration_from_sqlite3_to_postgres_command
    environment:
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: admin
      POSTGRES_DB: admin
